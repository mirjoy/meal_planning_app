$(document).ready(function(){
  toggleFoodList('#specific-food-header', '#specific-food');
  toggleFoodList('#allergy-header', '#allergy');
  toggleFoodList('#diet-header', '#diet');

  function toggleFoodList(foodCategory, foodList){
    $(foodCategory).bind('click', function(){
      if ($(foodList).hasClass('hidden')){
        $('.hated-food').addClass('hidden');
      }
      else {
        $('.hated-food').addClass('hidden');
        $(foodList).removeClass('hidden');
      }
      $(foodList).toggleClass('hidden');
    });
  };

   $('.hated-food').find('button').on('click', function(){
    $(this).toggleClass('btn-danger');
  });

  $("#specific-food").on("ajax:success", function(e, data, status, xhr) {
    button = $('<button type="button" class="btn btn-danger one-banned-food" data-id=' + data.id + '>'+data.name+'</button>');
    return $("#banned-food-list").append(button);
  }).on("ajax:error", function(e, xhr, status, error) {
    return $("#banned-food-list").append("<p>ERROR</p>");
  });


   $('.one-banned-food').on('click', function(e){
      var food_id = $(this).attr("data-id");
      
      $.ajax({
          method: "DELETE",
          url: "/banned_foods" + "/" + food_id
        })

      return $(this).remove();
  });

});